<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Bilibili 扫码登录</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; background-color: #f4f4f4; text-align: center; }
        #container { background-color: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        #qrcode { margin-top: 10px; }
        p { color: #333; }
    </style>
</head>
<body>
    <div id="container">
        <h2>Bilibili 扫码登录</h2>
        <p>请使用Bilibili手机客户端扫描二维码</p>
        <div id="qrcode"></div>
    </div>
    <script>
        // --- Start of inlined qrcode.min.js ---
        var QRCode;!function(){function t(t){this.mode=r.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,n=this.data.length;e<n;e++){var i=this.data.charCodeAt(e);i>65536?(this.parsedData.push(240|i>>18&7),this.parsedData.push(128|i>>12&63),this.parsedData.push(128|i>>6&63),this.parsedData.push(128|63&i)):i>2048?(this.parsedData.push(224|i>>12&15),this.parsedData.push(128|i>>6&63),this.parsedData.push(128|63&i)):i>128?(this.parsedData.push(192|i>>6&31),this.parsedData.push(128|63&i)):this.parsedData.push(i)}this.parsedData.push.apply(this.parsedData,[]),this.parsedData.length!=this.data.length&&(this.parsedData.length=0,this.parsedData.push.apply(this.parsedData,[]))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function i(t,e){this.totalCount=t,this.dataCount=e}function o(){this.buffer=[],this.length=0}function r(){}function a(t,e){this.data=t,this.errorCorrectLevel=e}var s,h=1,l=2,u=4,c=8,f=0,d=1,g=2,p=3,m=4,v=5,y=6,w=7;t.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},e.prototype={isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[i][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,n),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(n>=0&&n<=6&&(0==i||6==i)||i>=0&&i<=6&&(0==n||6==n)||n>=2&&n<=4&&i>=2&&i<=4?this.modules[t+n][e+i]=!0:this.modules[t+n][e+i]=!1)},getBestMaskPattern:function(){for(var t=0,n=0,i=0;i<8;i++){this.makeImpl(!0,i);var o=r.getLostPoint(this);(0==i||t>o)&&(t=o,n=i)}return n},createMovieClip:function(t,e,n){var i=t.createEmptyMovieClip(e,n),o=1;this.make();for(var r=0;r<this.moduleCount;r++)for(var a=0;a<this.moduleCount;a++){var s=100*a+5,h=100*r+5;this.isDark(r,a)&&(i.createEmptyMovieClip("d"+o,o),i["d"+o].beginFill(0,100),i["d"+o].moveTo(s,h),i["d"+o].lineTo(s+100,h),i["d"+o].lineTo(s+100,h+100),i["d"+o].lineTo(s,h+100),i["d"+o].endFill(),o++)}return i},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=r.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],o=t[n];if(null==this.modules[i][o])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)a==-2||2==a||s==-2||2==s||0==a&&0==s?this.modules[i+a][o+s]=!0:this.modules[i+a][o+s]=!1}},setupTypeNumber:function(t){for(var e=r.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(var n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(t,e){for(var n=this.errorCorrectLevel<<3|e,i=r.getBCHTypeInfo(n),o=0;o<15;o++){var a=!t&&1==(i>>o&1);o<6?this.modules[o][8]=a:o<8?this.modules[o+1][8]=a:this.modules[this.moduleCount-15+o][8]=a}for(var o=0;o<15;o++){var a=!t&&1==(i>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=a:o<9?this.modules[8][15-o-1+1]=a:this.modules[8][15-o-1]=a}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,o=7,a=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var h=0;h<2;h++){if(null==this.modules[i][s-h]){var l=!1;a<t.length&&(l=1==(t[a]>>>o&1));var u=r.getMask(e,i,s-h);u&&(l=!l),this.modules[i][s-h]=l,o--,-1==o&&(a++,o=7)}}if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},e.createData=function(t,n,i){for(var a=o.getRSBlocks(t,n),s=new o,h=0;h<i.length;h++){var l=i[h];s.put(l.mode,4),s.put(l.getLength(),r.getLengthInBits(l.mode,t)),l.write(s)}for(var u=0,c=0;c<a.length;c++)u+=a[c].dataCount;if(s.getLengthInBits()>8*u)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*u+")");for(s.getLengthInBits()+4<=8*u&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*u)break;if(s.put(236,8),s.getLengthInBits()>=8*u)break;s.put(17,8)}return e.createBytes(s,a)},e.createBytes=function(t,e){for(var i=0,o=0,a=0,s=new Array(e.length),h=new Array(e.length),l=0;l<e.length;l++){var u=e[l].dataCount,c=e[l].totalCount-u;o=Math.max(o,u),a=Math.max(a,c),s[l]=new Array(u);for(var f=0;f<s[l].length;f++)s[l][f]=255&t.buffer[f+i];i+=u;var d=r.getErrorCorrectPolynomial(c),g=new n(s[l],d.getLength()-1),p=g.mod(d);h[l]=new Array(p.getLength()-1);for(var f=0;f<h[l].length;f++){var m=f+p.getLength()-h[l].length-1;h[l][f]=m>=0?p.get(m):0}}for(var v=0,y=0;y<e.length;y++)v+=e[y].totalCount;for(var w=new Array(v),b=0,f=0;f<o;f++)for(var l=0;l<e.length;l++)f<s[l].length&&(w[b++]=s[l][f]);for(var f=0;f<a;f++)for(var l=0;l<e.length;l++)f<h[l].length&&(w[b++]=h[l][f]);return w},n.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=r.gexp(r.glog(this.get(n))+r.glog(t.get(i)));return new n(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=r.glog(this.get(0))-r.glog(t.get(0)),i=new Array(this.getLength()),o=0;o<this.getLength();o++)i[o]=this.get(o);for(var o=0;o<t.getLength();o++)i[o]^=r.gexp(r.glog(t.get(o))+e);return new n(i,0).mod(t)}},i.getRSBlocks=function(t,e){var n=i.getRsBlockTable(t,e);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=n.length/3,r=[],a=0;a<o;a++)for(var s=n[3*a+0],h=n[3*a+1],l=n[3*a+2],u=0;u<s;u++)r.push(new i(h,l));return r},i.getRsBlockTable=function(t,e){switch(e){case h:return i.RS_BLOCK_TABLE[4*(t-1)+0];case l:return i.RS_BLOCK_TABLE[4*(t-1)+1];case u:return i.RS_BLOCK_TABLE[4*(t-1)+2];case c:return i.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[1,70,34],[1,70,26],[1,100,80],[1,100,64],[1,100,48],[1,100,36],[1,134,108],[1,134,86],[1,134,62],[1,134,46],[2,86,68],[2,86,54],[2,86,42],[2,86,32],[2,122,98],[2,122,78],[2,122,58],[2,122,44],[2,152,122],[2,152,98],[4,74,48],[4,74,36],[2,192,154],[4,90,72],[4,90,50],[4,90,36],[2,224,178],[4,106,84],[2,120,86,2,121,87],[2,108,68,2,109,69],[4,136,108],[4,136,86],[4,116,68,2,117,69],[4,154,124],[4,154,98],[4,140,110],[3,141,113],[4,180,144],[2,118,92,4,119,93],[4,174,138],[4,174,110],[4,164,132,2,165,133],[4,204,164],[4,204,128],[4,181,145,1,182,146],[4,226,178],[4,226,142],[3,221,177,4,222,178],[4,240,192],[4,240,152],[4,250,200,1,251,201],[4,282,226],[4,282,178],[4,272,216,4,273,217],[4,312,250],[4,312,198],[4,331,265,1,332,266],[4,321,257,4,322,258],[4,360,288],[4,360,228],[4,367,293,1,368,294],[4,403,323,4,404,324],[4,432,346],[4,432,274],[4,440,352,4,441,353],[4,480,384],[4,480,304],[4,490,392,4,491,393],[4,540,432],[4,540,340],[4,538,430,4,539,431],[4,596,476],[4,596,376],[4,604,482,4,605,483],[4,644,516],[4,644,406],[2,652,522,4,653,523],[4,700,560],[4,700,440],[4,722,576,4,723,577],[4,752,602],[4,752,478],[4,774,618,2,775,619],[4,812,650],[4,812,514],[4,868,694],[4,868,544],[6,856,684,2,857,685],[4,900,720],[4,900,570],[4,928,742,4,929,743],[4,988,790],[4,988,620],[6,973,779,4,974,780],[4,1022,818,2,1023,819],[6,1050,840],[4,1050,660],[6,1092,874,2,1093,875],[6,1120,896],[4,1120,704],[6,1156,924,4,1157,925],[6,1218,974],[4,1218,768],[6,1212,970,2,1213,971],[6,1276,1020],[4,1276,804],[6,1300,1040,4,1301,1041],[6,1358,1086],[4,1358,856],[7,1352,1082,4,1353,1083],[6,1440,1152],[4,1440,904],[6,1444,1156,4,1445,1157],[6,1504,1204],[4,1504,944],[8,1512,1210,4,1513,1211],[6,1576,1260],[4,1576,992],[8,1598,1278,4,1599,1279],[8,1664,1332],[4,1664,1048],[8,1688,1350,4,1689,1351],[8,1752,1402],[4,1752,1100],[8,1756,1404,4,1757,1405],[10,1840,1472],[4,1840,1160],[9,1832,1466,4,1833,1467],[10,1936,1548],[4,1936,1224],[9,1960,1568,4,1961,1569],[10,2040,1632],[6,2040,1280],[11,2028,1622,5,2029,1623],[12,2112,1690],[6,2112,1328],[11,2152,1722,5,2153,1723],[12,2240,1792],[8,2240,1408],[12,2272,1818,4,2273,1819],[12,2368,1894],[8,2368,1488],[13,2352,1882,4,2353,1883],[12,2472,1978],[8,2472,1556],[13,2480,1984,4,2481,1985],[14,2576,2060],[10,2576,1620],[15,2592,2074,5,2593,2075],[14,2696,2156],[10,2696,1696],[15,2724,2180,5,2725,2181],[16,2824,2260],[10,2824,1776],[16,2856,2284,5,2857,2285],[17,2952,2362],[10,2952,1856],[17,2944,2356,5,2945,2357],[18,3056,2444],[10,3056,1920],[17,3088,2470,7,3089,2471],[18,3184,2548],[12,3184,2000],[18,3248,2598,6,3249,2599],[19,3344,2676],[12,3344,2104],[18,3352,2682,6,3353,2683],[20,3448,2758],[12,3448,2168],[19,3508,2806,6,3509,2807],[20,3608,2886],[13,3608,2264],[19,3640,2912,6,3641,2913],[20,3744,2996],[14,3744,2352],[20,3808,3046,7,3809,3047],[21,3904,3124],[14,3904,2452],[21,3912,3130,7,3913,3131],[22,4032,3226],[14,4032,2532],[22,4064,3252,7,4065,3253]],o.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},r.PATTERNS=[[0,0,0,0,0,0,0],[0,1,0,1,0,1,0],[0,1,0,1,0,1,0],[0,1,0,1,0,1,0],[0,1,0,1,0,1,0],[0,1,0,1,0,1,0],[0,1,0,1,0,1,0]],r.G15=1335,r.G18=7973,r.G15_MASK=21522,r.getBCHTypeInfo=function(t){for(var e=t<<10;r.getBCHDigit(e)-r.getBCHDigit(r.G15)>=0;)e^=r.G15<<r.getBCHDigit(e)-r.getBCHDigit(r.G15);return(t<<10|e)^r.G15_MASK},r.getBCHTypeNumber=function(t){for(var e=t<<12;r.getBCHDigit(e)-r.getBCHDigit(r.G18)>=0;)e^=r.G18<<r.getBCHDigit(e)-r.getBCHDigit(r.G18);return t<<12|e},r.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>=1;return e},r.getPatternPosition=function(t){return r.PATTERN_POSITION_TABLE[t-1]},r.getMask=function(t,e,n){switch(t){case f:return(e+n)%2==0;case d:return e%2==0;case g:return n%3==0;case p:return(e+n)%3==0;case m:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case v:return e*n%2+e*n%3==0;case y:return(e*n%2+e*n%3)%2==0;case w:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},r.getErrorCorrectPolynomial=function(t){for(var e=new n([1],0),i=0;i<t;i++)e=e.multiply(new n([1,r.gexp(i)],0));return e},r.getLengthInBits=function(t,e){if(e>=1&&e<10)switch(t){case h:return 10;case l:return 9;case u:return 8;case c:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case h:return 12;case l:return 11;case u:return 16;case c:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case h:return 14;case l:return 13;case u:return 16;case c:return 12;default:throw new Error("mode:"+t)}}},r.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var o=0;o<e;o++){for(var a=0,s=!1,h=i;h<e;h++){if(t.isDark(h,o)==s)a++;else{a>=5&&(n+=3+a-5),a=1,s=!t.isDark(h,o)}}a>=5&&(n+=3+a-5);for(var a=0,s=!1,l=o;l<e;l++){if(t.isDark(i,l)==s)a++;else{a>=5&&(n+=3+a-5),a=1,s=!t.isDark(i,l)}}a>=5&&(n+=3+a-5)}for(var i=0;i<e-1;i++)for(var o=0;o<e-1;o++){var u=0;t.isDark(i,o)&&u++,t.isDark(i+1,o)&&u++,t.isDark(i,o+1)&&u++,t.isDark(i+1,o+1)&&u++,(0==u||4==u)&&(n+=3)}for(var i=0;i<e;i++)for(var o=0;o<e-6;o++)t.isDark(i,o)&&!t.isDark(i,o+1)&&t.isDark(i,o+2)&&t.isDark(i,o+3)&&t.isDark(i,o+4)&&!t.isDark(i,o+5)&&t.isDark(i,o+6)&&(n+=40);for(var o=0;o<e;o++)for(var i=0;i<e-6;i++)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);for(var c=0,i=0;i<e;i++)for(var o=0;o<e;o++)t.isDark(i,o)&&c++;var f=Math.abs(100*c/e/e-50)/5;return n+=10*f},r.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,30,58,86,110],[6,34,62,90,114],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],r.glog=function(t){if(t<1)throw new Error("glog("+t+")");return r.LOG_TABLE[t]},r.gexp=function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return r.EXP_TABLE[t]},r.EXP_TABLE=new Array(256),r.LOG_TABLE=new Array(256);for(var b=0;b<8;b++)r.EXP_TABLE[b]=1<<b;for(var b=8;b<256;b++)r.EXP_TABLE[b]=r.EXP_TABLE[b-4]^r.EXP_TABLE[b-5]^r.EXP_TABLE[b-6]^r.EXP_TABLE[b-8];for(var b=0;b<255;b++)r.LOG_TABLE[r.EXP_TABLE[b]]=b;a.prototype={get:function(t,e){var n=Math.floor(t/this.data.width),i=Math.floor(e/this.data.height);return this.data.isDark(n,i)},getWidth:function(){return this.data.width},getHeight:function(){return this.data.height}},"string"==typeof s&&(s={text:s}),s=s||{},s.text=s.text||"",s.width=s.width||256,s.height=s.height||256,s.colorDark=s.colorDark||"#000000",s.colorLight=s.colorLight||"#ffffff",s.correctLevel=s.correctLevel||e.CorrectLevel.H;var _=function(t,n){var i=n||e.CorrectLevel.H,o=new e(s(t,i),i);o.addData(t);var r=document.createElement("canvas");r.width=n,r.height=n;var a=r.getContext("2d");o.make();for(var h=0;h<o.getModuleCount();h++)for(var l=0;l<o.getModuleCount();l++){a.fillStyle=o.isDark(h,l)?"#000000":"#ffffff";var u=Math.round((h+1)*n/o.getModuleCount())-Math.round(h*n/o.getModuleCount()),c=Math.round((l+1)*n/o.getModuleCount())-Math.round(l*n/o.getModuleCount());a.fillRect(Math.round(l*n/o.getModuleCount()),Math.round(h*n/o.getModuleCount()),c,u)}return r.toDataURL()},s=function(t,e){for(var n=1,i=u(t),o=0,r=0,a=new o;o<i.length;o++){var s=i[o];a.put(s.mode,4),a.put(s.getLength(),s.getLengthInBits(s.mode,n)),s.write(a),r+=s.getLength()}for(var h=0,l=0;l<8;l++){var c=new e(n,l);c.addData(t);var f=c.dataCache.length;f>h&&(h=f,n++)}return n};QRCode=function(n,i){if(this._htOption=i||{},"string"==typeof n&&(this._htOption.text=n),!n)throw new Error("el is not defined");this._el=n,this._oQRCode=null,this._oDrawing=null,this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(t){this._oQRCode=new e(s(t,this._htOption.correctLevel||e.CorrectLevel.H),this._htOption.correctLevel||e.CorrectLevel.H),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing=new k(this._el,this._htOption),this._oDrawing.draw(this._oQRCode),this.clear()},QRCode.prototype.makeImage=function(){return"function"==typeof this._oDrawing.makeImage?this._oDrawing.makeImage():void 0},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel={L:l,M:h,Q:c,H:u};var k=function(){var t=!!document.createElement("canvas").getContext;return function(e,n){this._bIsPainted=!1,this._android=function(){var t=!1,e=navigator.userAgent;return/android/i.test(e)&&(t=!0,e.toString().match(/android ([0-9]\.[0-9])/),RegExp.$1<"2.1"&&(t=!1)),t}(),this._el=e,this._htOption=n,this._oContext=null,this._oDrawing=null,this._oQRCode=null,this._bSupportDataURI=null,this._bSupportDataURI=function(){var e=document.createElement("canvas");return!(!t||!e.getContext("2d")||"string"!=typeof e.toDataURL()||!e.toDataURL().match(/^data:image\/png/))}(),this.makeImage=function(){if(this._oQRCode){var t=new a(this._oQRCode),e=this._htOption.width,n=this._htOption.height,i=document.createElement("canvas");i.width=e,i.height=n,i.style.width=e+"px",i.style.height=n+"px";for(var o=i.getContext("2d"),r=e/t.getWidth(),s=n/t.getHeight(),h=0;h<t.getHeight();h++)for(var l=0;l<t.getWidth();l++){o.fillStyle=t.get(h,l)?this._htOption.colorDark:this._htOption.colorLight;var u=Math.ceil((l+1)*r)-Math.floor(l*r),c=Math.ceil((h+1)*s)-Math.floor(h*s);o.fillRect(Math.round(l*r),Math.round(h*s),u,c)}return i.toDataURL()}return!1},this.draw=function(e){var n=e,i=this._el,o=this._htOption;if(!i)return;var r=o.width||256,a=o.height||256,s=o.colorDark||"#000000",h=o.colorLight||"#ffffff";if(this._oQRCode=n,t){this._oDrawing=new a(this._oQRCode),this._oContext=document.createElement("canvas").getContext("2d"),this._oContext.canvas.width=r,this._oContext.canvas.height=a;for(var l=r/this._oQRCode.getModuleCount(),u=a/this._oQRCode.getModuleCount(),c=0;c<this._oQRCode.getModuleCount();c++)for(var f=0;f<this._oQRCode.getModuleCount();f++){this._oContext.fillStyle=this._oQRCode.isDark(c,f)?s:h;var d=Math.ceil((f+1)*l)-Math.floor(f*l),g=Math.ceil((c+1)*u)-Math.floor(c*u);this._oContext.fillRect(Math.floor(f*l),Math.floor(c*u),d,g)}this._bIsPainted=!0,this.clear(),this.render()}else{var p,m,v,y,w=this._oQRCode.getModuleCount(),b=o.width/w,k=o.height/w,C=Math.round(b),T=Math.round(k),E=document.createElement("table");E.style.width=o.width+"px",E.style.height=o.height+"px",E.style.border="0",E.style.borderCollapse="collapse",E.style.backgroundColor=o.colorLight;for(var L=0;L<this._oQRCode.getModuleCount();L++){var A=document.createElement("tr");A.style.height=k+"px";for(var D=0;D<this._oQRCode.getModuleCount();D++){var x=document.createElement("td");x.style.width=b+"px",x.style.height=k+"px",x.style.backgroundColor=this._oQRCode.isDark(L,D)?o.colorDark:o.colorLight,A.appendChild(x)}E.appendChild(A)}i.appendChild(E),this._bIsPainted=!0,this.clear(),this.render()}},this.render=function(){var t=this._el,e=this._oContext;if(!t)return;if(this._android)return void this.makeImage();if(this._bSupportDataURI){var n=document.createElement("img");n.style.width=this._htOption.width+"px",n.style.height=this._htOption.height+"px",n.src=e.canvas.toDataURL("image/png"),t.appendChild(n)}else{var i=document.createElement("div");i.innerHTML=this._oContext.canvas.toDataURL("image/png"),t.appendChild(i.firstChild)}},this.clear=function(){this._el.innerHTML=""}}}(),u=function(e){for(var n=[],i=0;i<e.length;){var o=e.charCodeAt(i);if(o>=0&&o<=127)n.push(o),i++;else if(o>=128&&o<=2047)n.push(192|o>>6&31),n.push(128|63&o),i++;else if(o>=2048&&o<=65535)n.push(224|o>>12&15),n.push(128|o>>6&63),n.push(128|63&o),i++;else if(o>=65536&&o<=1114111)n.push(240|o>>18&28),n.push(128|o>>12&63),n.push(128|o>>6&63),n.push(128|63&o),i++;else{i++;var r=new t(e);n=r.parsedData}}return n}}();
        // --- End of inlined qrcode.min.js ---

        // --- Start of original inline script ---
        document.addEventListener('DOMContentLoaded', () => {
            // 监听来自主窗口的消息
            window.addEventListener('message', (event) => {
                // 安全性检查：确保消息来自预期的源
                if (event.origin !== window.location.origin) {
                    console.warn("收到来自未知源的消息:", event.origin);
                    return;
                }

                if (event.data && event.data.type === 'BILI_QR_URL') {
                    const qrUrl = event.data.url;
                    if (qrUrl) {
                        new QRCode(document.getElementById('qrcode'), { text: qrUrl, width: 200, height: 200, colorDark: "#000000", colorLight: "#ffffff", correctLevel: QRCode.CorrectLevel.H });
                    } else {
                        document.getElementById('qrcode').textContent = '错误：未收到有效的二维码链接。';
                    }
                }
            });
        });
    </script>
</body>
</html>